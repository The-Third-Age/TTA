# Remove this line to have the validator check for strings in localisation
# Audax Validator "!" Ignore_1004

# Remove this line to have the validator check this file
# Audax Validator "!" Ignore_NEXT

# Barding Realm Events
# 50900 - 50999

# The Integration of Odriksdun
province_event = {
	id = 50900
	title = "The Integration of Odriksdún"
	desc = "EVTDESC50900"
	fire_only_once = yes
	
	trigger = {
		owner = { tag = DAL }
		province_id = 652 # Dale
		650 = { empty = yes } # Odriksdun
	}
	
	mean_time_to_happen = {
		months = 6
	}
	
	option = {
		name = "Another village joins the realm"
		
		650 = { secede_province = THIS } # Odriksdun
	}
}

# Bard's Ultimatum to the Rivermen
country_event = {
	id = 50901
	title = "An Ultimatum From $FROMCOUNTRY$"
	desc = "EVTDESC50901"
	picture = "gramavuld/bard_war"
	is_triggered_only = yes
	
	option = {
		name = "We will join"
		
		FROM = { country_event = 50902 }
		
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				tag = DA3
			}
			modifier = {
				factor = 2
				# alliance_with = FROM
				alliance_with = DAL
			}
		}
	}
	
	option = {
		name = "To war!"
		
		FROM = { country_event = 50903 }
		all_core = { add_core = FROM } # To make sure that should DAL fail, they can attempt to do it again
		
		# Actually be able to afford their army (at first)
		treasury = 100000
		
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				OR = {
					tag = DA1
					has_global_flag = DAL_protected_the_rivermen
				}
			}
		}
	}
}

# The Rivermen Accept
country_event = {
	id = 50902
	title = "$FROMCOUNTRY$ Accepts the Ultimatum"
	desc = "EVTDESC50902"
	picture = "gramavuld/bard_war"
	is_triggered_only = yes
	
	option = {
		name = "Welcome to $COUNTRY$!"
		
		create_vassal = FROM
		relation = { who = FROM value = 400 }
		create_alliance = FROM
		
		# If we are a GP, sphere the minor
		random_owned = {
			limit = { owner = { is_greater_power = yes } }
			owner = { diplomatic_influence = { who = FROM value = 400 } }
		}
	}
}

# The Rivermen Refuse
country_event = {
	id = 50903
	title = "$FROMCOUNTRY$ Refuses the Ultimatum"
	desc = "EVTDESC50903"
	picture = "gramavuld/bard_war"
	is_triggered_only = yes
	
	option = {
		name = "They made their choice"
		
		casus_belli = {
			target = FROM
			type = conquest
			months = 12
		}
		
		add_casus_belli = {
			target = FROM
			type = humiliate
			months = 12
		}
		
		end_war = FROM
		
		war = {
			target = FROM
			attacker_goal = { casus_belli = conquest }
			defender_goal = { casus_belli = humiliate }
			call_ally = yes
		}
	}
}

province_event = {
	id = 50904
	title = "The Integration of the Grammas" 
	desc = "EVTDESC50904"
	
	trigger = {
		owner = {
			tag = DAL
			has_global_flag = DAL_invited_the_grammas
			
			# Grammas has core provinces that are uncolonized
			GRA = {
				any_core = {
					empty = yes
					OR = {
						region = DAL_643
						region = DAL_642
						region = DAL_640
					}
					any_neighbor_province = { owned_by = THIS }
				}
			}
		}
		province_id = 652 # Dale
	}
	
	mean_time_to_happen = {
		months = 12
	}
	
	option = {
		name = "We welcome our brothers"
		
		owner = {
			# Adds a targetting modifier to all eligible provinces
			GRA = {
				all_core = {
					limit = {
						empty = yes
						OR = {
							region = DAL_643
							region = DAL_642
							region = DAL_640
						}
						any_neighbor_province = { owned_by = THIS }
					}
					add_province_modifier = { name = colonization_target duration = -1 }
				}
			}
			
			# Randomly grabs one of the marked provinces and annexes a random neighbor uncolonized core
			FOR = { 
				random_owned = { 
					random_empty_neighbor_province = { 
						limit = { has_province_modifier = colonization_target }
						secede_province = THIS
					}
				}
			}
			
			# Clears the targeting modifiers to clear the path for the next time this event fires
			GRA = { all_core = { remove_province_modifier = colonization_target } }
			
			DAL_colonize_grammas_province_loc = {}
		}
	}
}

country_event = {
	id = 50905
	title = "The Desolation of Smaug"
	desc = "EVTDESC50905"
	picture = "gramavuld/smaug"

	fire_only_once = yes

	trigger = {
		tag = DAL
	}
	
	option = {
		name = "Smaug's legacy continues"
		
		141 = { add_province_modifier = { name = smaugs_desolation duration = -1 } }
		652 = { add_province_modifier = { name = reconstruction_started_smaugs_desolation duration = -1 } }
		653 = { add_province_modifier = { name = smaugs_desolation duration = -1 } }
		654 = { add_province_modifier = { name = reconstruction_started_smaugs_desolation duration = -1 } }
		655 = { add_province_modifier = { name = smaugs_desolation duration = -1 } }
		656 = { add_province_modifier = { name = smaugs_desolation duration = -1 } }
	}
}

province_event = {
	id = 50906
	title = "Reconstruction from Smaug's Destruction"
	desc = "EVTDESC50906"
	
	trigger = {
		has_province_modifier = smaugs_desolation
		owner = { money = 25000 }
	}
	
	mean_time_to_happen = {
		months = 60
		
		modifier = {
			factor = 0.5
			owner = { money = 100000 }
		}
		
		modifier = {
			factor = 0.5
			owner = { money = 250000 }
		}
	}
	
	option = {
		name = "It is time"
		
		owner = { treasury = -25000 }
		remove_province_modifier = smaugs_desolation
		add_province_modifier = { name = reconstruction_started_smaugs_desolation duration = -1 }
	}
	
	option = {
		name = "We have other matters to attend"
	}
}

province_event = {
	id = 50907
	title = "Reconstruction from Smaug's Destruction"
	desc = "EVTDESC50907"
	
	trigger = {
		has_province_modifier = reconstruction_started_smaugs_desolation
	}
	
	mean_time_to_happen = {
		months = 180
		
		modifier = {
			factor = 0.75
			guilds_3 = 1
		}
	}
	
	option = {
		name = "We are removing a stain from the land and memory"
		
		remove_province_modifier = reconstruction_started_smaugs_desolation
		add_province_modifier = { name = reconstruction_finished_smaugs_desolation duration = 730 }
	}
}

# Trussel-Day
province_event = {
	id = 50908
	title = "Trussell-Day"
	desc = "EVTDESC50908"
	
	mean_time_to_happen = {
		months = 240
		
		modifier = {
			factor = 2
			
			owner = { war = yes }
		}
	}
	
	trigger = {
		owner = { is_culture_group = northmen }
		province_id = 652 # Dale
	}
	
	option = {
		name = "Thrushes are always our friends"
		
		owner = { 
			prestige = 1
			any_pop = {
				militancy = -0.5
				consciousness = -0.5
			}
		}
	}
}

# Completion of the Mere's End (Lindal) Boat Lift
country_event = {
	id = 50909
	title = "The Mere's End Boat Lift"
	desc = "EVTDESC50909"
	picture = "production"
	
	is_triggered_only = yes
	
	option = {
		name = "Now trade can flow more easily"
		
		remove_country_modifier = meres_end_constructing_boat_lift
		set_global_flag = DAL_meres_end_boat_lift_constructed
		
		649 = { add_province_modifier = { name = meres_end_increased_trade duration = -1 } }
		653 = { add_province_modifier = { name = meres_end_increased_trade duration = -1 } }
		654 = { add_province_modifier = { name = meres_end_increased_trade duration = -1 } }
	}
}

# Dragon Gold
province_event = {
	id = 50910
	title = "Gold in Long Lake!"
	desc = "EVTDESC50910"
	
	mean_time_to_happen = {
		months = 150
		
		modifier = {
			factor = 2
			
			year = 2960
		}
		modifier = {
			factor = 2
			year = 2970
		}
		modifier = {
			factor = 2
			year = 2980
		}
		modifier = {
			factor = 2
			year = 2990
		}
		modifier = {
			factor = 2
			year = 3000
		}
		modifier = {
			factor = 2
			year = 3010
		}
		modifier = {
			factor = 2
			year = 3020
		}
	}
	
	trigger = {
		OR = {
			province_id = 649
			province_id = 653
			province_id = 654
		}
	}
	
	option = {
		name = "A mightly find indeed"
		
		owner = { treasury = 8000 }
	}
}

# Frithalf, Lord of Riding
country_event = {
	id = 50911
	title = "Frithalf, Lord of Riding"
	desc = "EVTDESC50911"
	picture = "gramavuld/bard_war"
	fire_only_once = yes
	
	mean_time_to_happen = {
		months = 60
	}
	
	trigger = {
		tag = DAL
		OR = {
			has_global_flag = DAL_invited_the_grammas
			accepted_culture = grammas
		}
	}
	
	option = {
		name = "A new general is always welcome"
		
		define_general = {
			name = "§LFrithalf, §MLord of Riding§!"
			background = lord_of_riding
			personality = persistent
		}
	}
}

# Eynar, Lord of Riding
country_event = {
	id = 50912
	title = "Eynar, Lord of Riding"
	desc = "EVTDESC50911"
	picture = "gramavuld/bard_war"
	fire_only_once = yes
	
	mean_time_to_happen = {
		months = 60
	}
	
	trigger = {
		tag = DAL
		OR = {
			has_global_flag = DAL_invited_the_grammas
			accepted_culture = grammas
		}
		year = 2970
		owns = 640 # Grasgarda
	}
	
	option = {
		name = "A new general is always welcome"
		
		define_general = {
			name = "§LEynar, §MLord of Riding§!"
			background = lord_of_riding
			personality = ballsy
		}
	}
}

# Oyvind, Captain of Erland's Ferry
country_event = {
	id = 50913
	title = "Oyvind, Master of Erland's Ferry"
	desc = "EVTDESC50913"
	picture = "gramavuld/bard_war"
	fire_only_once = yes
	
	mean_time_to_happen = {
		months = 60
	}
	
	trigger = {
		tag = DAL
		OR = {
			has_global_flag = DAL_invited_the_grammas
			accepted_culture = grammas
		}
		year = 2990
		owns = 446 # Erland's Ferry
	}
	
	option = {
		name = "A new general is always welcome"
		
		define_general = {
			name = "§LOyvind, §MCaptain of Erland's Ferry§!"
			background = captain_of_erlands_ferry
			personality = resolute
		}
	}
}

# Lodin, Captain of Royal Archers
country_event = {
	id = 50914
	title = "Lodin, Captain of the Royal Archers"
	desc = "EVTDESC50914"
	picture = "gramavuld/bard_war"
	fire_only_once = yes
	
	mean_time_to_happen = {
		months = 60
	}
	
	trigger = {
		tag = DAL
		owns = 652 # Dale
		year = 3005
	}
	
	option = {
		name = "A new general is always welcome"
		
		define_general = {
			name = "§LLodin, §MCaptain of the Royal Archers§!"
			background = captain_of_royal_archers
			personality = aggressive
		}
	}
}