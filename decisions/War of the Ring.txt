# Imladris Decisons: {
#	Council of Elrond 
#	War of the Ring}

# ring_controller mapping:
#	0 = Bilbo
#	1 = Frodo
#	2 = Fellowship

# Council of Elrond
political_decisions = {
	council_of_elrond = {
		potential = {
			FOR = {
				check_variable = {
					which = ring_controller
					value = 1 # Frodo
				}
				NOT = {
					check_variable = {
						which = ring_controller
						value = 2 # Anyone else
					}
				}
			}
			year = 3000
			good_evil_alignment = good_alignment
			NOT = { has_global_flag = the_council_of_elrond }	
		}
		
		allow = {
			OR = {
				diplomacy_5 = 1
				year = 3010
			}
			OR = {
				AND = {
					tag = IML
					nationalvalue = elrond
				}
				AND = {
					tag = IML
					NOT = { nationalvalue = elrond }
					is_greater_power = yes
				}
				AND = {
					NOT = { tag = IML }
					is_greater_power = yes
					IML = {
						NOT = { nationalvalue = elrond }
						is_greater_power = no
					}
				}
			}
		}
		
		effect = {
			set_global_flag = the_council_of_elrond
			set_country_flag = the_council_of_elrond_host
			any_country = {
				limit = {
					good_evil_alignment = good_alignment
					NOT = { tag = IML }
					is_vassal = no
					OR = {
						is_greater_power = yes
						is_secondary_power = yes
					}
				}
				country_event = 50300
			}
			country_event = {
				id = 50303
				days = 3
			}
		}
	}
}

# War of the Ring
political_decisions = {
	war_of_the_ring_leader_selection = {
		picture = "war_of_the_ring"
		
		potential = {
			tag = FOR
			check_variable = {
				which = ring_controller
				value = 2 # Fellowship
			}
			NOT = {
				check_variable = {
					which = ring_controller
					value = 3 # Anyone else
				}
			}
			NOT = { has_country_modifier = wotr_countdown }
			NOT = { has_global_flag = wotr_leaders_chosen }
		}
		
		allow = {}
		
		effect = {
			random_country = {
				limit = {
					OR = {
						AND = {
							OR = {
								tag = GON
								AND = {
									is_greater_power = yes
									ai = no
								}
							}
							good_evil_alignment = good_alignment
						}
						AND = {
							NOT = { GON = { good_evil_alignment = good_alignment } }
							good_evil_alignment = good_alignment
							is_greater_power = yes
						}
						AND = {
							NOT = { GON = { good_evil_alignment = good_alignment } }
							NOT = { any_greater_power = { good_evil_alignment = good_alignment } }
							good_evil_alignment = good_alignment
						}
					}
				}
				set_country_flag = good_leader
				country_event = 50304
				country_event = { id = 50306 days = 1 }
			}
			
			random_country = {
				limit = {
					OR = {
						AND = {
							OR = {
								tag = MOR
								AND = {
									is_greater_power = yes
									ai = no
								}
							}
							good_evil_alignment = evil_alignment
						}
						AND = {
							NOT = { MOR = { good_evil_alignment = evil_alignment } }
							good_evil_alignment = evil_alignment
							is_greater_power = yes
						}
						AND = {
							NOT = { MOR = { good_evil_alignment = evil_alignment } }
							NOT = { any_greater_power = { good_evil_alignment = evil_alignment } }
							good_evil_alignment = evil_alignment
						}
					}
				}
				set_country_flag = evil_leader
				country_event = 50305
			}
			
			set_global_flag = wotr_leaders_chosen
		}
	}
	
	war_of_the_ring_ensure_realms_fight = {
		picture = "war_of_the_ring"
		
		potential = {
			tag = FOR
			any_neighbor_country = { war = no }
			NOT = { has_country_flag = get_realms_to_fight }
			any_neighbor_country = { has_country_flag = good_leader }
			any_neighbor_country = { has_country_flag = evil_leader }
		}
		
		allow = {}
		
		effect = {
			any_neighbor_country = {
				limit = {
					war = no
					good_evil_alignment = good_alignment
				}
				country_event = 50308
			}
			
			any_neighbor_country = {
				limit = {
					war = no
					good_evil_alignment = evil_alignment
				}
				country_event = 50309
			}
			
			set_country_flag = get_realms_to_fight
		}
	}
	
	war_of_the_ring_ensure_realms_fight_2 = {
		picture = "war_of_the_ring"
		
		potential = {
			tag = FOR
			has_country_flag = get_realms_to_fight
		}
		
		allow = {}
		
		effect = {
			any_neighbor_country = {
				limit = {
					has_country_flag = good_leader
					has_country_flag = good_needs_to_fight
				}
				clr_country_flag = good_needs_to_fight
				country_event = 50310
			}
			
			any_neighbor_country = {
				limit = {
					has_country_flag = evil_leader
					has_country_flag = evil_needs_to_fight
				}
				clr_country_flag = evil_needs_to_fight
				country_event = 50310
			}
			
			clr_country_flag = get_realms_to_fight
		}
	}
}